# Predicting Air Travel Trends with Linear Regression

## Setting the Scene

So far, we have explored the Flights dataset from Seaborn, analyzed trends, and visualized these trends using various charts such as line plots and heat maps. Today, we focus on leveraging this historical data to predict future trends using a technique known as Linear Regression.

Linear regression is a powerful tool used to predict an outcome (dependent variable) based on one or more predictor (independent) variables, forming a linear relationship. For instance, we might wish to forecast future passenger numbers based on past trends using our air travel dataset.

Why is this important? Anticipating future trends is key to strategic decision-making. Airlines, for example, use these predictions for numerous operational and strategic decisions, such as scheduling flights, capacity planning, resource allocation, and strategic expansions. Let's see how we can make such predictions!

## Introduction to Linear Regression
Linear regression assumes a linear relationship between the dependent and predictor variable(s), which can be represented as: 
y=a+bâˆ—x. Here, y is the dependent variable we want to predict, x is our predictor variable, a is the y-intercept, and b is the slope of the line. In the context of our Flights dataset, y can represent the number of passengers, and x can represent time (years or months).

```Python

import seaborn as sns
import pandas as pd

flights_data = sns.load_dataset("flights")
flights_data['year'] = pd.to_datetime(flights_data['year'], format='%Y')
flights_pivot = pd.pivot_table(data=flights_data, values='passengers', index='year', aggfunc='sum').reset_index()

import matplotlib.pyplot as plt
from sklearn.linear_model import LinearRegression
import numpy as np

# Extracting the year from the date and converting it into the appropriate format
flights_pivot['year'] = flights_pivot['year'].dt.year

X = np.array(flights_pivot['year']).reshape(-1,1)
y = flights_pivot['passengers']

reg = LinearRegression().fit(X, y)

plt.scatter(X, y, color = "m", marker = "o", s = 30)

Y_pred = reg.predict(X)
plt.plot(X, Y_pred, color = "g")

plt.xlabel('Year')
plt.ylabel('Passengers')
plt.title('Linear Regression: Passengers Over Time')
plt.show()
```
In the above code example, we load the Flights dataset and pivot it to get the total passenger count for each year. Next, we create our Linear Regression model and fit it to the data (years and passenger counts). We use a scatter plot to visualize the data points, while the line plot indicates our fitted regression line.

The purple dots represent the actual number of passengers for each year from 1949 to 1960, plotted against the year. The green line represents the line of best fit generated by linear regression. This line aims to minimize the total distance between itself and each point (which signifies the error or residual). It represents our model's best guess for the passenger count given a particular year.

![image](https://github.com/user-attachments/assets/bc606704-0add-4c10-acad-5c17b12111f4)


## Quality of Fit: *The R-Squared Statistic*

A natural question arises: how good is our model's fit? This can be answered using R-squared, a statistical measure representing the proportion of the variance for a dependent variable explained by an independent variable(s) in a regression model. It provides a measure of how well the model will likely predict future outcomes.

```Python

print ("R-squared statistic: ", reg.score(X, y))
```
The closer the `R-squared` statistic is to 1.0, the better the regression equation accounts for the variation in the dependent variable. An `R-squared` score of 1 indicates that the regression predictions perfectly fit the data. An `R-squared` score of one usually provides excellent predictions from the model.

## Future Predictions

Now our model is created and validated, we can use it to predict future passenger traffic.

```Python

# Forecast for the next 10 years
new_years = np.array(range(1961, 1971)).reshape(-1,1)
new_passenger_numbers = reg.predict(new_years)
print("Year, Predicted Passengers")
for year, passengers in zip(new_years, new_passenger_numbers):
    print(f"{year[0]}, {int(passengers)}")
```

Here, we're predicting passenger counts for the years 1961 to 1971. The LinearRegression.predict function is used to perform the predictions. It generates the dependent variable's predicted values based on the linear regression model.

Each line of the output is as follows:

```Markdown
Copy to clipboard
1961, 5853
1962, 6236
1963, 6619
1964, 7002
1965, 7386
1966, 7769
1967, 8152
1968, 8535
1969, 8918
1970, 9301
```
This proves our linear regression model, suggesting that the number of passengers will increase yearly from 1961 through 1970.
